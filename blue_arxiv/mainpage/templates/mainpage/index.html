{% extends 'base.html' %}

{% load static %}

{% block head_content %}
    <link rel="stylesheet" href="{% static 'mainpage/css/index.css' %}">
    <title>blueArXiv</title>
{% endblock %}

{% block body_content %}
<div class="header-container">
    <img src="{% static 'mainpage/images/arXiv.png' %}" alt="logo" class="logo">
    <div class="search-container">
        <form class="search-form" action="#" method="post">
            {% csrf_token %}
            <input type="text" name="search" class="search-input" placeholder="æœç´¢è®ºæ–‡...">
            <select name="search_field" class="search-field">
                <option value="all">å…¨éƒ¨</option>
                <option value="title">æ ‡é¢˜</option>
                <option value="author">ä½œè€…</option>
                <option value="abstract">æ‘˜è¦</option>
            </select>
            <button type="submit" class="search-button">æœç´¢</button>
        </form>
        {% if user.is_authenticated %}
        <!-- å¦‚æœç”¨æˆ·å·²ç™»å½•ï¼Œæ˜¾ç¤ºç”¨æˆ·åå’Œå¤´åƒ -->
        <div class="user-info">
            <p>Welcome, {{ user.username }}!</p>
            <!-- å¦‚æœç”¨æˆ·æœ‰å¤´åƒ -->
            <div class="avatar-container">
                {% if user.avatar %}
                    <img src="{{ user.avatar.url }}" alt="User Avatar" class='avatar'>
                {% else %}
                    <img src="{% static 'mainpage/images/default_avatar.gif' %}" alt="Default Avatar" class='avatar'>
                {% endif %}
                <div class="dropdown-content">
                    <form method="post" action="{% url 'user_home' user.username %}">
                        {% csrf_token %}
                        <button type="submit">ç”¨æˆ·èµ„æ–™</button>
                    </form>
                    <form method="post" action="{% url 'logout' %}">
                        {% csrf_token %}
                        <button type="submit">ç™»å‡º</button>
                    </form>                        
                </div>
            </div>
        </div>
        {% else %}
        <!-- å¦‚æœç”¨æˆ·æœªç™»å½•ï¼Œæ˜¾ç¤ºç™»å½•æŒ‰é’® -->
        <form method="post" action="{% url 'user_login' %}">
            {% csrf_token %}
            <button type="submit" class="login-button">ç™»å½•</button>
        </form>
        {% endif %}
    </div>
</div>

<div class="container">
    <section class="featured-articles">
        {% if not user.is_authenticated %}
        <h2>ğŸ˜„ç™»å½•ä»¥è·å–æ›´ç›¸å…³æ¨è</h2>
        {% endif %}
        
        {% for article in articles %}            
        <article>
            {% if user.is_authenticated %}
            <form method="post" action="{% url 'vote' article.arxiv_id %}">
                {% csrf_token %}
                <button type="submit" class="vote-up">ğŸ‘</button>
            </form>
            <form method="post" action="{% url 'neg' article.arxiv_id %}">
                {% csrf_token %}
                <button type="submit" class="vote-up">ğŸ¦¶</button>
            </form>
            {% endif %}
            <h3>{{ article.title }}</h3>
            <p class="author">Author: {{ article.authors }}</p>
            <p>Abstract: {{ article.abstract }}</p>
        </article>
        {% endfor %}
    </section>
</div>
{% endblock %}